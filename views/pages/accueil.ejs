<!DOCTYPE html>
<!--
  @file accueil.ejs
  @author Elliot Wood
  @version 1.0
  @date 2025-09-02
  @brief Page d'accueil alternative utilisant EJS.
-->

<html>
    


<head>
    <%- include('../partials/head') %>
</head>
<body class="container">
    <header>
        <%- include('../partials/header') %>
    </header>

    <main>
        <div class="jumbotron">
            <h1>Accueil</h1>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Date de creation</th>
                        <th>Nom</th>
                        <th>Prix</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (items && items.length) { %>
                        <% items.forEach(item => { %>
                            <tr>
                                <td><%= item.id %></td>
                                <td><%= item.dateCreation %></td>
                                <td><%= item.nom %></td>
                                <td><%= item.prix.toFixed(2) %> $</td>
                            </tr>
                        <% }) %>
                    <% } else { %>
                        <tr><td colspan="4">Aucun item disponible.</td></tr>
                    <% } %>
                </tbody>
            </table>
        </div>
        <% if (message) { %>
            <div class="alert alert-danger alert-dismissible">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                <h3><%= message %></h3>
            </div>
        <% } %>
        <div class="jumbotron">
            <h2> Supprimer un élément par ID:</h2>
            <form id="deleteItemForm" method="POST" action="/deleteById">
                    <input type="number" class="form-control" id="itemId" name="id" required>
                <button type="submit" class="btn btn-danger">Supprimer</button>
            </form>
            <h2> Supprimer un élément par nom:</h2>
            <form id="deleteItemForm" method="POST" action="/deleteByName">
                    <input type="text" class="form-control" id="itemName" name="nom" required>
                <button type="submit" class="btn btn-danger">Supprimer</button>
            </form>
        </div>
        <div class="jumbotron">
            <h2>Ajouter un item</h2>
            <form id="addItemForm" method="POST" action="/add">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Prix</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <input type="text" class="form-control" id="itemName" name="nom" required>
                            </td>
                            <td>
                                <input type="number" class="form-control" id="itemPrice" name="prix" step="0.01" required>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <button type="submit" class="btn btn-primary">Ajouter</button>
            </form>
        </div>
        <div class="jumbotron">
            <h2>Modifier un item:</h2>
            <form id="modifyItemForm" method="POST" action="/modify">
                <table class="table">
                    <thead>
                        <tr>
                            <th>ID de l'item à modifier</th>
                            <th>Nouveau nom</th>
                            <th>Nouveau prix</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <input type="number" class="form-control" id="itemId" name="id" required>
                            </td>
                            <td>
                                <input type="text" class="form-control" id="itemName" name="nom" required>
                            </td>
                            <td>
                                <input type="number" class="form-control" id="itemPrice" name="prix" step="0.01" required>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <button type="submit" class="btn btn-info">Modifier</button>
            </form>
        <script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();  
    socket.on('updateItems', (items) => {
        console.log("Liste mise à jour via Socket.IO", items);
        location.reload();  
    });
</script>
    </main>
    

    <footer>
        <%- include('../partials/footer') %>
    </footer>
</body>
</html>